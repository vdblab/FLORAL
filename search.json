[{"path":"https://vdblab.github.io/FLORAL/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Contributor Code of Conduct","title":"Contributor Code of Conduct","text":"contributors maintainers project, pledge respect people contribute reporting issues, posting feature requests, updating documentation, submitting pull requests patches, activities. committed making participation project harassment-free experience everyone, regardless level experience, gender, gender identity expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion. Examples unacceptable behavior participants include use sexual language imagery, derogatory comments personal attacks, trolling, public private harassment, insults, unprofessional conduct. Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct. Project maintainers follow Code Conduct may removed project team. Instances abusive, harassing, otherwise unacceptable behavior may reported opening issue contacting one project maintainers. Code Conduct adapted Contributor Covenant (https://www.contributor-covenant.org), version 1.0.0, available https://contributor-covenant.org/version/1/0/0/.","code":""},{"path":"https://vdblab.github.io/FLORAL/articles/Using-FLORAL-for-Microbiome-Analysis.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Using FLORAL for Microbiome Analysis","text":"using data curatedMetagenomicData package. easier installation, saved flat copy data, steps show created.","code":"if (! \"BiocManager\" %in% installed.packages()) install.packages(\"BiocManager\") if (! \"curatedMetagenomicData\" %in% installed.packages()) BiocManager::install(\"curatedMetagenomicData\") if (! \"patchwork\" %in% installed.packages()) install.packages(\"patchwork\") library(curatedMetagenomicData)  # Take a look at the summary of the studies available: curatedMetagenomicData::sampleMetadata  |> group_by(.data$study_name, .data$study_condition) |> count() |> arrange(.data$study_name)  #As an example, let us look at the `YachidaS_2019` study between healthy controls and colorectal cancer (CRC) patients. curatedMetagenomicData::curatedMetagenomicData(\"YachidaS_2019\")  # note --  if you are behind a firewall, see the solutions to 500 errors here: # https://support.bioconductor.org/p/132864/ rawdata <- curatedMetagenomicData::curatedMetagenomicData(\"2021-03-31.YachidaS_2019.relative_abundance\", dryrun = FALSE, counts = TRUE) |>  mergeData() x <- SummarizedExperiment::assays(rawdata)$relative_abundance %>% t() y <- rawdata@colData$disease  save(list = c(\"x\", \"y\"),  file = file.path(\"inst\", \"extdata\", \"YachidaS_2019.Rdata\")) load(system.file(\"extdata\", \"YachidaS_2019.Rdata\", package=\"FLORAL\"))"},{"path":"https://vdblab.github.io/FLORAL/articles/Using-FLORAL-for-Microbiome-Analysis.html","id":"running-floral","dir":"Articles","previous_headings":"","what":"Running FLORAL","title":"Using FLORAL for Microbiome Analysis","text":"extracted data TreeSummarizedExperiment object two objects: taxa matrix x “outcomes” vector y whether patient healthy colorectal cancer (CRC). Note binary outcomes, input vector y needs formatted entries equal either 0 1. addition, need specify family = \"binomial\" FLORAL fit logistic regression model. print progress bar algorithm runs, please use progress = TRUE.","code":"x <- x[y %in% c(\"CRC\",\"healthy\"),] x <- x[,colSums(x >= 100) >= nrow(x)*0.2] # filter low abundance taxa  y <- as.numeric(as.factor(y[y %in% c(\"CRC\",\"healthy\")]))-1 fit <- FLORAL(x = x, y = y, family=\"binomial\", ncv=10, progress=TRUE) #> Algorithm running for full dataset:  #> Algorithm running for cv dataset 1 out of 10:  #> Algorithm running for cv dataset 2 out of 10:  #> Algorithm running for cv dataset 3 out of 10:  #> Algorithm running for cv dataset 4 out of 10:  #> Algorithm running for cv dataset 5 out of 10:  #> Algorithm running for cv dataset 6 out of 10:  #> Algorithm running for cv dataset 7 out of 10:  #> Algorithm running for cv dataset 8 out of 10:  #> Algorithm running for cv dataset 9 out of 10:  #> Algorithm running for cv dataset 10 out of 10:"},{"path":"https://vdblab.github.io/FLORAL/articles/Using-FLORAL-for-Microbiome-Analysis.html","id":"interpreting-the-model","dir":"Articles","previous_headings":"","what":"Interpreting the Model","title":"Using FLORAL for Microbiome Analysis","text":"FLORAL, like methods optimization step, two “best” solutions \\(\\lambda\\) available: one minimizing mean squared error (\\(\\lambda_\\min\\)), one maximizing value \\(\\lambda\\) withing 1 standard error minimum mean squared error (\\(\\lambda_{\\text{1se}}\\)). referred min 1se solutions, respectively. can see mean squared error (MSE) coefficients vs log(\\(\\lambda\\)) follows:  plots, vertical dashed line dotted line represent \\(\\lambda_\\min\\) \\(\\lambda_{\\text{1se}}\\), respectively. MSE plot, bands represent plus minus one standard error MSE. coefficient plot, colored lines represent individual taxa, taxa non-zero values \\(\\lambda_\\min\\) \\(\\lambda_{\\text{1se}}\\) selected predictive outcome. view specific names selected taxa, please see fit$selected.feature$min fit$selected.feature$1se vectors. view coefficient estimates, please see fit$best.beta$min fit$best.beta$1se. Without looking ratios, one can crudely interpret positive negative association taxon outcome positive negative sign coefficient estimates. However, recommend referring two-step procedure discussed rigorous interpretation based ratios, derived log-ratio model assumption.","code":"fit$pmse + fit$pcoef head(fit$selected.feature$min) #> [1] \"k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02\"                 #> [2] \"k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_ICM47\"                      #> [3] \"k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum\" #> [4] \"k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Micrococcales|f__Micrococcaceae|g__Rothia|s__Rothia_mucilaginosa\"                                #> [5] \"k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens\"                 #> [6] \"k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Eggerthellales|f__Eggerthellaceae|g__Asaccharobacter|s__Asaccharobacter_celatus\"  head(sort(fit$best.beta$min)) #>                  k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra  #>                                                                                                                        -0.07745931  #> k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens  #>                                                                                                                        -0.04532596  #> k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02  #>                                                                                                                        -0.03744493  #>  k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis  #>                                                                                                                        -0.03314198  #>          k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Anaerotruncus|s__Anaerotruncus_colihominis  #>                                                                                                                        -0.02707009  #>      k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus  #>                                                                                                                        -0.02092297"},{"path":"https://vdblab.github.io/FLORAL/articles/Using-FLORAL-for-Microbiome-Analysis.html","id":"the-two-step-procedure","dir":"Articles","previous_headings":"","what":"The Two-step Procedure","title":"Using FLORAL for Microbiome Analysis","text":"previous section, checked lasso estimates without identifying specific ratios predictive outcome (CRC case). default, FLORAL performs two-step selection procedure use glmnet step regression identify taxa pairs form predictive log-ratios. view pairs, use fit$step2.ratios$min fit$step2.ratios$1se names ratios fit$step2.ratios$min.idx fit$step2.ratios$1se.idx pairs indices original input count matrix x. Note one taxon can occur multiple ratios. interpret positive negative associations outcome, please refer output step regression tables, effect sizes ratios can found. corresponding p-values also available, recommend using p-values criterion rank strength association. recommend directly reporting p-values inference, p-values obtained running first step lasso model without rigorous post-selective inference. However, still valid claim selected log-ratios predictive outcome, demonstrated improved 10-fold cross-validated prediction errors.","code":"head(fit$step2.ratios$`1se`) #> [1] \"k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_plebeius/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_dorei\"                                              #> [2] \"k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_eligens/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus\"                                        #> [3] \"k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum\" #> [4] \"k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus|s__Streptococcus_salivarius/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02\"                           #> [5] \"k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Erysipelatoclostridium|s__Erysipelatoclostridium_ramosum/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra\"              #> [6] \"k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_sp_CAG_38\"  fit$step2.ratios$`1se.idx` #>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] #> [1,]    1    4   12   22   26   27   27   44   73    81   114 #> [2,]    2  113  102  128  131   90  151   64   80   128   131 fit$step2.tables$`1se` #>                                                                                                                                                                                                                                                                                                                                    Estimate #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_plebeius/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_dorei                                                                                        -0.02659576 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_eligens/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus                                                                                   0.04043200 #> k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum                                           -0.04886115 #> k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus|s__Streptococcus_salivarius/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                      0.09235497 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Erysipelatoclostridium|s__Erysipelatoclostridium_ramosum/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                         0.04784129 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_sp_CAG_38                                                                            -0.03798158 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Proteobacteria|c__Proteobacteria_unclassified|o__Proteobacteria_unclassified|f__Proteobacteria_unclassified|g__Proteobacteria_unclassified|s__Proteobacteria_bacterium_CAG_139 -0.03610014 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Anaerotruncus|s__Anaerotruncus_colihominis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnoclostridium|s__Clostridium_aldenense                                                                             -0.07966635 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnospira|s__Lachnospira_pectinoschiza/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Blautia|s__Ruminococcus_torques                                                                                           0.03247124 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Roseburia|s__Roseburia_faecis/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                                  0.05287895 #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Barnesiellaceae|g__Coprobacter|s__Coprobacter_fastidiosus/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                                                      0.06757447 #>                                                                                                                                                                                                                                                                                                                                 Std. Error #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_plebeius/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_dorei                                                                                        0.01099163 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_eligens/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus                                                                                  0.01385914 #> k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum                                           0.01507927 #> k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus|s__Streptococcus_salivarius/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                     0.02625928 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Erysipelatoclostridium|s__Erysipelatoclostridium_ramosum/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                        0.01965003 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_sp_CAG_38                                                                            0.01622550 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Proteobacteria|c__Proteobacteria_unclassified|o__Proteobacteria_unclassified|f__Proteobacteria_unclassified|g__Proteobacteria_unclassified|s__Proteobacteria_bacterium_CAG_139 0.01837978 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Anaerotruncus|s__Anaerotruncus_colihominis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnoclostridium|s__Clostridium_aldenense                                                                             0.02173633 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnospira|s__Lachnospira_pectinoschiza/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Blautia|s__Ruminococcus_torques                                                                                          0.01300914 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Roseburia|s__Roseburia_faecis/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                                 0.01743096 #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Barnesiellaceae|g__Coprobacter|s__Coprobacter_fastidiosus/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                                                     0.01818976 #>                                                                                                                                                                                                                                                                                                                                   z value #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_plebeius/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_dorei                                                                                        -2.419638 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_eligens/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus                                                                                   2.917353 #> k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum                                           -3.240286 #> k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus|s__Streptococcus_salivarius/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                      3.517042 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Erysipelatoclostridium|s__Erysipelatoclostridium_ramosum/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                         2.434668 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_sp_CAG_38                                                                            -2.340857 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Proteobacteria|c__Proteobacteria_unclassified|o__Proteobacteria_unclassified|f__Proteobacteria_unclassified|g__Proteobacteria_unclassified|s__Proteobacteria_bacterium_CAG_139 -1.964123 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Anaerotruncus|s__Anaerotruncus_colihominis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnoclostridium|s__Clostridium_aldenense                                                                             -3.665124 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnospira|s__Lachnospira_pectinoschiza/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Blautia|s__Ruminococcus_torques                                                                                           2.496033 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Roseburia|s__Roseburia_faecis/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                                  3.033621 #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Barnesiellaceae|g__Coprobacter|s__Coprobacter_fastidiosus/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                                                      3.714973 #>                                                                                                                                                                                                                                                                                                                                     Pr(>|z|) #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_plebeius/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_dorei                                                                                        0.0155359842 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_eligens/k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Bacteroidaceae|g__Bacteroides|s__Bacteroides_cellulosilyticus                                                                                  0.0035301655 #> k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_aerofaciens/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Bifidobacteriales|f__Bifidobacteriaceae|g__Bifidobacterium|s__Bifidobacterium_pseudocatenulatum                                           0.0011940974 #> k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Streptococcaceae|g__Streptococcus|s__Streptococcus_salivarius/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                     0.0004363849 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Erysipelatoclostridium|s__Erysipelatoclostridium_ramosum/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                        0.0149054787 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Eubacteriaceae|g__Eubacterium|s__Eubacterium_sp_CAG_38                                                                            0.0192395438 #> k__Bacteria|p__Firmicutes|c__Erysipelotrichia|o__Erysipelotrichales|f__Erysipelotrichaceae|g__Holdemania|s__Holdemania_filiformis/k__Bacteria|p__Proteobacteria|c__Proteobacteria_unclassified|o__Proteobacteria_unclassified|f__Proteobacteria_unclassified|g__Proteobacteria_unclassified|s__Proteobacteria_bacterium_CAG_139 0.0495158342 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Anaerotruncus|s__Anaerotruncus_colihominis/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnoclostridium|s__Clostridium_aldenense                                                                             0.0002472185 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Lachnospira|s__Lachnospira_pectinoschiza/k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Blautia|s__Ruminococcus_torques                                                                                          0.0125590844 #> k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Lachnospiraceae|g__Roseburia|s__Roseburia_faecis/k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Actinomycetales|f__Actinomycetaceae|g__Actinomyces|s__Actinomyces_sp_HMSC035G02                                                                                 0.0024163753 #> k__Bacteria|p__Bacteroidetes|c__Bacteroidia|o__Bacteroidales|f__Barnesiellaceae|g__Coprobacter|s__Coprobacter_fastidiosus/k__Bacteria|p__Firmicutes|c__Tissierellia|o__Tissierellales|f__Peptoniphilaceae|g__Parvimonas|s__Parvimonas_micra                                                                                     0.0002032250"},{"path":"https://vdblab.github.io/FLORAL/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Teng Fei. Author, maintainer, copyright holder. Tyler Funnell. Author. Nicholas Waters. Author. Sandeep Raj. Author.","code":""},{"path":"https://vdblab.github.io/FLORAL/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Fei T, Funnell T, Waters N, Raj S (2023). FLORAL: FLORAL: Fit LOg-RAtio Lasso regression compositional covariates. R package version 0.1, https://vdblab.github.io/FLORAL/.","code":"@Manual{,   title = {FLORAL: FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates},   author = {Teng Fei and Tyler Funnell and Nicholas Waters and Sandeep Raj},   year = {2023},   note = {R package version 0.1},   url = {https://vdblab.github.io/FLORAL/}, }"},{"path":"https://vdblab.github.io/FLORAL/index.html","id":"floral-fit-log-ratio-lasso-regression-for-compositional-covariates-","dir":"","previous_headings":"","what":"FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates","title":"FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates","text":"FLORAL package open-source computational tool perform log-ratio lasso regression modeling compositional feature selection continuous, binary, time--event, competing risk outcomes. proposed method adapts augmented Lagrangian algorithm zero-sum constraint optimization problem enabling two-stage screening process extended false-positive control.","code":""},{"path":"https://vdblab.github.io/FLORAL/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates","text":"can install development version FLORAL GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"vdblab/FLORAL\")"},{"path":"https://vdblab.github.io/FLORAL/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates","text":"toy example linear regression 10-fold cross-validation simulated data 50 samples 100 compositional features. Option progress=TRUE can used show progress bar running algorithm. data simulation procedure described preprint. view plots cross-validated prediction error parameter coefficients, use fit$pmse fit$pcoef:  view selected compositional features, use fit$selected.feature, features sorted names. Features min 1se correspond penalty parameter λmin λ1se, respectively. Features min.2stage 1se.2stage obtained applying 2-stage filtering based features min 1se, respectively. recommend interpreting selected compositional features potential predictive markers outcome regression model sense cross-validated prediction error improved considering selected features. get specific log-ratios selected 2-stage procedure, use fit$step2.log-ratios, min 1se display log-ratios features. identified ratio, min.idx 1se.idx return column indices original input matrix two corresponding features forming ratio. detailed interpretations can obtained selected log-ratios. First, selected log-ratios also improve cross-validated prediction errors log-ratios derived constrained lasso estimate. Moreover, guided association table log-ratios outcome, possible interpret directions covariate effects associated certain log-ratios outcome. view detailed associations selected log-ratios outcome, use fit$step2.tables print summary tables multivariable stepwise regression models obtained 2-stage procedure. binary survival outcomes, please specify family=\"binomial\" family=\"cox\" accordingly.","code":"set.seed(23420) library(FLORAL)  dat <- simu(n=50,p=100,model=\"linear\") fit <- FLORAL(dat$xcount,dat$y,family=\"gaussian\",ncv=10,progress=FALSE) fit$selected.feature #> $min #>  [1] \"taxa1\"  \"taxa10\" \"taxa13\" \"taxa2\"  \"taxa20\" \"taxa3\"  \"taxa32\" \"taxa39\" #>  [9] \"taxa5\"  \"taxa6\"  \"taxa60\" \"taxa7\"  \"taxa75\" \"taxa76\" \"taxa79\" \"taxa8\"  #> [17] \"taxa84\" \"taxa9\"  \"taxa92\" #>  #> $`1se` #>  [1] \"taxa1\"  \"taxa10\" \"taxa13\" \"taxa2\"  \"taxa20\" \"taxa3\"  \"taxa32\" \"taxa39\" #>  [9] \"taxa5\"  \"taxa6\"  \"taxa7\"  \"taxa75\" \"taxa8\"  \"taxa84\" \"taxa9\"  #>  #> $min.2stage #>  [1] \"taxa1\"  \"taxa10\" \"taxa13\" \"taxa2\"  \"taxa20\" \"taxa3\"  \"taxa32\" \"taxa5\"  #>  [9] \"taxa6\"  \"taxa60\" \"taxa7\"  \"taxa79\" \"taxa8\"  \"taxa84\" \"taxa9\"  \"taxa92\" #>  #> $`1se.2stage` #>  [1] \"taxa1\"  \"taxa10\" \"taxa13\" \"taxa2\"  \"taxa20\" \"taxa3\"  \"taxa32\" \"taxa5\"  #>  [9] \"taxa6\"  \"taxa7\"  \"taxa8\"  \"taxa84\" \"taxa9\" fit$step2.ratios #> $min #>  [1] \"taxa1/taxa13\" \"taxa1/taxa20\" \"taxa1/taxa84\" \"taxa2/taxa5\"  \"taxa3/taxa8\"  #>  [6] \"taxa3/taxa92\" \"taxa5/taxa8\"  \"taxa6/taxa9\"  \"taxa7/taxa10\" \"taxa7/taxa79\" #> [11] \"taxa8/taxa60\" \"taxa9/taxa32\" \"taxa9/taxa92\" #>  #> $`1se` #>  [1] \"taxa1/taxa13\" \"taxa1/taxa20\" \"taxa1/taxa84\" \"taxa2/taxa5\"  \"taxa3/taxa8\"  #>  [6] \"taxa5/taxa8\"  \"taxa6/taxa7\"  \"taxa6/taxa9\"  \"taxa7/taxa10\" \"taxa9/taxa32\" #>  #> $min.idx #>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] #> [1,]    1    1    1    2    3    3    5    6    7     7     8     9     9 #> [2,]   13   20   84    5    8   92    8    9   10    79    60    32    92 #>  #> $`1se.idx` #>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] #> [1,]    1    1    1    2    3    5    6    6    7     9 #> [2,]   13   20   84    5    8    8    7    9   10    32 fit$step2.tables$min fit$step2.tables$`1se` dat.bin <- simu(n=50,p=100,model=\"binomial\") fit.bin <- FLORAL(dat.bin$xcount,dat.bin$y,family=\"binomial\",ncv=10,progress=FALSE)  dat.cox <- simu(n=50,p=100,model=\"cox\") fit.cox <- FLORAL(dat.cox$xcount,survival::Surv(dat.cox$t,dat.cox$d),family=\"cox\",ncv=10,progress=FALSE)"},{"path":"https://vdblab.github.io/FLORAL/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"FLORAL: Fit LOg-RAtio Lasso regression for compositional covariates","text":"FLORAL package jointly managed MSKCC Biostatistics service Marcel van den Brink Lab. Please note FLORAL project released Contributor Code Conduct. contributing project, agree abide terms. Thank contributors!","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":null,"dir":"Reference","previous_headings":"","what":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"Conduct log-ratio lasso regression continuous, binary survival outcomes.","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"","code":"FLORAL(   x,   y,   family = \"gaussian\",   longitudinal = FALSE,   id = NULL,   tobs = NULL,   failcode = NULL,   length.lambda = 100,   lambda.min.ratio = NULL,   mu = 1,   ncv = 5,   intercept = FALSE,   foldid = NULL,   step2 = TRUE,   progress = TRUE,   plot = TRUE )"},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"x Count data matrix, rows specify subjects columns specify features. `x` contains longitudinal data, rows must sorted order subject IDs used `y`. y Outcome. continuous binary outcome, `y` vector. survival outcome, `y` `Surv` object. family Available options `gaussian`, `binomial`, `cox`, `finegray`. `finegray` still development. Please use caution. longitudinal TRUE FALSE, indicating whether longitudinal data matrix specified input `x`. (Still development. Please use caution) id `longitudinal` TRUE, `id` specifies subject IDs corresponding rows input `x`. tobs `longitudinal` TRUE, `tobs` specifies time points corresponding rows input `x`. failcode `family = finegray`, `failcode` specifies failure type interest. must positive integer. length.lambda Number penalty parameters used path lambda.min.ratio Ratio minimum maximum choice lambda. Default `NULL`, ratio chosen 1e-2 n < p 1e-4 otherwise. mu Value penalty augmented Lagrangian ncv Number cross-validation runs. Use `NULL` cross-validation wanted. intercept TRUE FALSE, indicating whether intercept estimated. foldid vector fold indicator. Default `NULL`. step2 TRUE FALSE, indicating whether second-stage feature selection specific ratios performed features selected main lasso algorithm. performed cross validation enabled. progress TRUE FALSE, indicating whether printing progress bar algorithm runs. plot TRUE FALSE, indicating whether returning plots model fitting.","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"list path-specific estimates (beta), path (lambda), many others.","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"Teng Fei. Email: feit1@mskcc.org","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/FLORAL.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"FLORAL: Fit Log-ratio lasso regression for compositional covariates — FLORAL","text":"","code":"set.seed(23420)  # Continuous outcome dat <- simu(n=50,p=30,model=\"linear\") fit <- FLORAL(dat$xcount,dat$y,family=\"gaussian\",progress=FALSE,step2=TRUE)  # Binary outcome dat <- simu(n=50,p=30,model=\"binomial\") fit <- FLORAL(dat$xcount,dat$y,family=\"binomial\",progress=FALSE,step2=TRUE)  # Survival outcome dat <- simu(n=50,p=30,model=\"cox\") fit <- FLORAL(dat$xcount,survival::Surv(dat$t,dat$d),family=\"cox\",progress=FALSE,step2=TRUE)"},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":null,"dir":"Reference","previous_headings":"","what":"simu: Simulate data following log-ratio model — simu","title":"simu: Simulate data following log-ratio model — simu","text":"Simulate dataset log-ratio model","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simu: Simulate data following log-ratio model — simu","text":"","code":"simu(   n = 100,   p = 200,   model = \"linear\",   weak = 4,   strong = 6,   weaksize = 0.125,   strongsize = 0.25,   pct.sparsity = 0.5,   rho = 0,   intercept = FALSE )"},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simu: Simulate data following log-ratio model — simu","text":"n integer sample size p integer number features (taxa). model Type models associated outcome variable, can `\"linear\"`, `\"binomial\"`, `\"cox\"`. weak Number features `weak` effect size. strong Number features `strong` effect size. weaksize Actual effect size `weak` effect size. Must positive. strongsize Actual effect size `strong` effect size. Must positive. pct.sparsity Percentage zero counts sample. rho Parameter controlling correlated structure taxa. Ranges 0 1. intercept Boolean. TRUE, random intercept generated model. works `\"linear\"` `\"binomial\"` models.","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simu: Simulate data following log-ratio model — simu","text":"list simulated count matrx `xcount`, `log1p`-transformed count matrix `x`, outcome (continuous `y`, continuous centered `y0`, binary `y`, survival `t`,`d`), true coefficient vector `beta`, list non-zero features `idx`, value intercept `intercept` (applicable).","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"simu: Simulate data following log-ratio model — simu","text":"Teng Fei. Email: feit1@mskcc.org","code":""},{"path":"https://vdblab.github.io/FLORAL/reference/simu.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simu: Simulate data following log-ratio model — simu","text":"","code":"set.seed(23420) dat <- simu(n=50,p=30,model=\"linear\")"}]
